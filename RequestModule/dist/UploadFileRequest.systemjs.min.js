System.register([],function(a){'use strict';return{execute:function(){function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function d(a,b,d){return b&&c(a.prototype,b),d&&c(a,d),a}var e=function(){function a(c){var d=c.url,e=c.file,f=c.onSuccess,g=c.onProgress,h=c.onError,i=c.authentication,j=c.formKey,k=void 0===j?a.defaults.formKey:j,l=c.AuthManagerBridge,m=void 0===l?a.defaults.AuthManagerBridge:l;b(this,a),this.http=null,this.data=null,this.url=d,this.file=e,this.onSuccess=f,this.onProgress=g,this.onError=h,this.authentication=void 0===i||i,this.AuthManagerBridge=m,this.formKey=k,this.createRequest(),this.createData(),this.uploadFile()}return d(a,[{key:"uploadFile",value:function(){if(this.http.open("POST",this.url,!0),this.authentication){var a=this.AuthManagerBridge.getAuthHeaderProperty();this.http.setRequestHeader(a.key,a.value)}this.http.send(this.data)}},{key:"createRequest",value:function(){this.http=new XMLHttpRequest,this.registerOnReadyStateChange(),this.registerOnProgressUplaod()}},{key:"createData",value:function(){this.data=new FormData,this.data.append(this.formKey,this.file)}},{key:"registerOnReadyStateChange",value:function(){var a=this;this.http.onreadystatechange=function(){4==a.http.readyState&&200==a.http.status?a.registerOnSuccessRequest():4==a.http.readyState&&200!=a.http.status&&a.registerOnErrorRequest()}}},{key:"registerOnSuccessRequest",value:function(){this.http.getResponseHeader("Content-Type").indexOf("json")&&this.onSuccess(JSON.parse(this.http.responseText))}},{key:"registerOnErrorRequest",value:function(){this.http.getResponseHeader("Content-Type").indexOf("json")&&this.onError(JSON.parse(this.http.responseText))}},{key:"registerOnProgressUplaod",value:function(){var a=this;this.http.upload.addEventListener("progress",function(b){var c=Math.round;if(b.lengthComputable){var d=c(100*(b.loaded/b.total));a.onProgress(d,b.loaded,b.total,b)}},!1)}}]),a}();e.defaults={AuthManagerBridge:void 0,formKey:void 0},a("default",e)}}});
